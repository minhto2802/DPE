<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DPE: Diverse Prototypical Ensembles (ICML 2025)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&family=Roboto:wght@400;500&family=Roboto+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&family=Roboto:wght@400;500&family=Roboto+Mono&display=swap" rel="stylesheet">

 <head>
  <meta charset="UTF-8">
  <title>DPE: Diverse Prototypical Ensembles (ICML 2025)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Unified Google Fonts request -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&family=Roboto:wght@400;500&family=Roboto+Mono&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      color: #222;
      max-width: 960px;
      margin: auto;
      padding: 2rem;
      line-height: 1.6;
    }

    h1, h2, h3, th {
      font-family: 'Inter', sans-serif;
    }

    .monospace, p.monospace {
      font-family: 'Roboto Mono', monospace;
      font-size: 0.9rem;
      color: #444;
    }

    .authors, .links {
      text-align: center;
    }

    .button {
      display: inline-block;
      margin: 6px;
      padding: 10px 18px;
      background-color: #333;
      color: white;
      border-radius: 20px;
      text-decoration: none;
      font-size: 14px;
    }

    img {
      display: block;
      max-width: 100%;
      margin: 20px auto;
    }

    summary {
      font-family: 'Inter', sans-serif;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      background: #eef4ff;
      padding: 10px 16px;
      border-radius: 6px;
      margin: 1.5rem 0;
    }

    details[open] summary {
      background: #dde8ff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      font-size: 15px;
      font-family: 'Roboto', sans-serif;
    }

    th {
      background: #f5f5f5;
      padding: 10px;
      font-weight: 600;
      text-align: center;
    }

    td {
      padding: 8px 10px;
      border: 1px solid #ddd;
      text-align: center;
    }

    tr:nth-child(even) {
      background-color: #fafafa;
    }

    tr.highlight {
      background-color: #f0f0f0;
    }

    .std {
      font-size: 12px;
      font-family: 'Roboto Mono', monospace;
      color: #555;
    }

    .bold {
      font-weight: 600;
    }

    .underline {
      text-decoration: underline;
    }

    pre {
      background-color: #f4f4f4;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
  </style>
</head>

  
<body>

<h1>Diversified Prototypical Ensembles (DPE)</h1>
<p class="authors">
  Minh Nguyen Nhat To, Paul F R Wilson, Viet Nguyen, Mohamed Harmanani, Michael Cooper<br>
  Fahimeh Fooladgar, Purang Abolmaesumi, Parvin Mousavi, Rahul Krishnan
</p>

<div class="links">
  <a href="../_ICML2025__Shift_Happens_.pdf" class="button">ðŸ“„ Paper</a>
  <a href="https://anonymous.4open.science/r/prototypical_ensembles-BCB3" class="button">ðŸ’» Code</a>
</div>

  
<h2>Abstract</h2>
<p>
  Subpopulation shifts, characterized by disparities in subpopulation distributions between training and target datasets, can significantly degrade model performance. We propose DPE, a method that augments a frozen feature extractor with a set of prototype classifiers trained to diversify across latent subpopulations. Our approach outperforms prior methods in worst-group accuracy across nine real-world benchmarks without using subgroup labels.
</p>

<h2>Visual Overview</h2>


<h3>Worst-Group Accuracy (No Subgroup Labels)</h3>
<p>
The top half reproduces results from SubpopBench using the same ERM backbone.
The bottom half includes stronger ERM* baselines and our DPE results.
</p>
  
<h2>Visual Overview</h2>
<img src="../figures/cov_loss_ablation.jpg" alt="Covariance Loss Ablation">

<h3>Worst-Group Accuracy (No Subgroup Labels)</h3>
<p class="monospace">
The top section uses the same ERM backbone as SubpopBench. The bottom uses ERM* and our DPE on a stronger backbone.
</p>


<h2>Benchmark Results</h2>

<details>
<summary>ðŸ“Š <strong>Worst-Group Accuracy â€” No Subgroup Labels</strong></summary>
<table>
  <thead>
    <tr>
      <th>Algorithm</th>
      <th>Waterbirds</th>
      <th>CelebA</th>
      <th>CivilComments</th>
      <th>MultiNLI</th>
      <th>MetaShift</th>
      <th>CheXpert</th>
      <th>ImageNetBG</th>
      <th>NICO++</th>
      <th>Living17</th>
    </tr>
  </thead>
  <tbody>
    <!-- Top half (ERM backbone) -->
    <tr>
      <td><strong>ERM</strong></td>
      <td>69.1 <span class="std">Â±4.7</span></td>
      <td>57.6 <span class="std">Â±0.8</span></td>
      <td>63.2 <span class="std">Â±1.2</span></td>
      <td><b>66.4</b> <span class="std">Â±2.3</span></td>
      <td>82.1 <span class="std">Â±0.8</span></td>
      <td>41.7 <span class="std">Â±3.4</span></td>
      <td>76.8 <span class="std">Â±0.9</span></td>
      <td>35.0 <span class="std">Â±4.1</span></td>
      <td>48.0 <span class="std">Â±1.5</span></td>
    </tr>
    <tr>
      <td><strong>CRT</strong></td>
      <td>76.3 <span class="std">Â±0.8</span></td>
      <td>69.6 <span class="std">Â±0.7</span></td>
      <td><b>67.8</b> <span class="std">Â±0.3</span></td>
      <td>65.4 <span class="std">Â±0.2</span></td>
      <td>83.1 <span class="std">Â±0.0</span></td>
      <td>74.6 <span class="std">Â±0.4</span></td>
      <td><b>78.2</b> <span class="std">Â±0.5</span></td>
      <td>33.3 <span class="std">Â±0.0</span></td>
      <td>â€“</td>
    </tr>
    <tr>
      <td><strong>ReWeightCRT</strong></td>
      <td>76.3 <span class="std">Â±0.2</span></td>
      <td>70.7 <span class="std">Â±0.6</span></td>
      <td>64.7 <span class="std">Â±0.2</span></td>
      <td>65.2 <span class="std">Â±0.2</span></td>
      <td><b><u>85.1</u></b> <span class="std">Â±0.4</span></td>
      <td><b>75.1</b> <span class="std">Â±0.2</span></td>
      <td>77.5 <span class="std">Â±0.7</span></td>
      <td>33.3 <span class="std">Â±0.0</span></td>
      <td>â€“</td>
    </tr>
    <tr>
      <td><strong>DFR</strong></td>
      <td><b>89.0</b> <span class="std">Â±0.2</span></td>
      <td><b>73.7</b> <span class="std">Â±0.8</span></td>
      <td>64.4 <span class="std">Â±0.1</span></td>
      <td>63.8 <span class="std">Â±0.0</span></td>
      <td>81.4 <span class="std">Â±0.1</span></td>
      <td><b><u>75.8</u></b> <span class="std">Â±0.3</span></td>
      <td>74.4 <span class="std">Â±1.8</span></td>
      <td><b>38.0</b> <span class="std">Â±3.8</span></td>
      <td>â€“</td>
    </tr>
    <tr class="highlight">
      <td><strong>ERM + DPE</strong></td>
      <td><b><u>91.0</u></b> <span class="std">Â±0.5</span></td>
      <td><b><u>81.9</u></b> <span class="std">Â±0.2</span></td>
      <td><b><u>69.9</u></b> <span class="std">Â±0.9</span></td>
      <td><b><u>69.3</u></b> <span class="std">Â±0.8</span></td>
      <td><b>84.1</b> <span class="std">Â±1.5</span></td>
      <td>â€“</td>
      <td><b><u>87.9</u></b> <span class="std">Â±0.6</span></td>
      <td><b><u>50.0</u></b> <span class="std">Â±0.0</span></td>
      <td><b><u>54.0</u></b> <span class="std">Â±4.0</span></td>
    </tr>

    <!-- Bottom half (ERM* backbone) -->
    <tr>
      <td><strong>ERM*</strong></td>
      <td>77.9 <span class="std">Â±3.0</span></td>
      <td>66.5 <span class="std">Â±2.6</span></td>
      <td><b><u>69.4</u></b> <span class="std">Â±1.2</span></td>
      <td>66.5 <span class="std">Â±0.7</span></td>
      <td>80.0 <span class="std">Â±0.0</span></td>
      <td>75.6 <span class="std">Â±0.4</span></td>
      <td>86.4 <span class="std">Â±0.8</span></td>
      <td>33.3 <span class="std">Â±0.0</span></td>
      <td>53.3 <span class="std">Â±0.9</span></td>
    </tr>
    <tr>
      <td><strong>RWY</strong></td>
      <td>86.1 <span class="std">Â±0.7</span></td>
      <td><b>82.9</b> <span class="std">Â±2.2</span></td>
      <td>67.5 <span class="std">Â±0.6</span></td>
      <td>68.0 <span class="std">Â±1.9</span></td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
    </tr>
    <tr>
      <td><strong>AFR</strong></td>
      <td><b>90.4</b> <span class="std">Â±1.1</span></td>
      <td>82.0 <span class="std">Â±0.5</span></td>
      <td>68.7 <span class="std">Â±0.6</span></td>
      <td><b><u>73.4</u></b> <span class="std">Â±0.6</span></td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
      <td>â€“</td>
    </tr>
    <tr class="highlight">
      <td><strong>ERM* + DPE</strong></td>
      <td><b><u>94.1</u></b> <span class="std">Â±0.2</span></td>
      <td><b><u>84.6</u></b> <span class="std">Â±0.8</span></td>
      <td><b>68.9</b> <span class="std">Â±0.6</span></td>
      <td><b>70.9</b> <span class="std">Â±0.8</span></td>
      <td><b><u>83.6</u></b> <span class="std">Â±0.9</span></td>
      <td><b><u>76.8</u></b> <span class="std">Â±0.1</span></td>
      <td><b><u>88.1</u></b> <span class="std">Â±0.7</span></td>
      <td><b><u>50.0</u></b> <span class="std">Â±0.0</span></td>
      <td><b><u>63.0</u></b> <span class="std">Â±1.7</span></td>
    </tr>
  </tbody>
</table>
</details>
<h2>BibTeX</h2>
<pre>
@inproceedings{to2025dpe,
  title={Diverse Prototypical Ensembles Improve Robustness to Subpopulation Shift},
  author={To, Minh Nguyen Nhat and Wilson, Paul F R and Nguyen, Viet and Harmanani, Mohamed and Cooper, Michael and
          Fooladgar, Fahimeh and Abolmaesumi, Purang and Mousavi, Parvin and Krishnan, Rahul},
  booktitle={International Conference on Machine Learning (ICML)},
  year={2025}
}
</pre>

</body>
</html>
