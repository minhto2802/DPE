<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>DPE: Diverse Prototypical Ensembles (ICML 2025)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Unified Google Fonts request -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&family=Roboto:wght@400;500&family=Roboto+Mono&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&family=Roboto&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Source+Sans+Pro&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Lato&display=swap" rel="stylesheet">

    <style>
        .table-box {
            background-color: #FFF4FD;
            border-radius: 12px;
            padding: 12px;
            margin: 2rem 0;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);
        }

        .card-section {
            background-color: #fff7ed; /* soft peach background */
            padding: 24px;
            border-radius: 12px;
            margin: 2rem 0;
            font-family: 'Georgia', serif; /* classic serif font */
            color: rgb(32, 0, 0);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); /* soft shadow */
            /*border: 1px solid #f1e0d3; !* light border for contrast *!*/
        }

        .card-section.summary-section {
            background-color: #edf7f6; /* light teal or choose another distinct tone */
        }

        .card-section h2 {
            /*font-family: 'Merriweather', serif;*/
            font-family: 'Roboto Mono', monospace;
            font-size: 1.5rem;
            color: rgba(193, 41, 41, 0.73);
            margin-bottom: 1rem;
        }

        .card-section ul {
            padding-left: 1.25rem;
        }

        .card-section li {
            margin-bottom: 0.5rem;
        }

        .card-section ul, .card-section li {
            font-family: 'Lato', sans-serif;
        }

        .card-section {
            background-color: #eef6fb;
            padding: 24px;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .card-section h3 {
            text-align: justify;
            font-family: 'Inter', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .card-section p {
            text-align: justify;
            font-family: 'Roboto', sans-serif;
            font-size: 1rem;
            color: #333;
            line-height: 1.6;
        }

        .card-section .math {
            text-align: center;
            font-size: 1.1rem;
            font-style: italic;
            margin: 1rem 0;
            font-family: 'Roboto Mono', monospace;
        }

        pre {
            overflow-x: auto;
            white-space: pre-wrap;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.95rem;
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            margin: 1rem 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            max-width: 900px;
            margin: auto;
            padding: 40px 20px;
            color: #222;
        }

        h1, h2, h3 {
            font-family: 'Inter', sans-serif;
            text-align: center;
        }

        .authors, .institution, .links, .summary {
            text-align: center;
        }

        .button {
            display: inline-block;
            background: rgb(57, 39, 25);
            color: #ffffff;
            padding: 10px 16px;
            margin: 4px;
            border-radius: 999px;
            text-decoration: none;
            font-size: 14px;
        }

        .button:hover {
            background: rgb(151, 93, 57);
        }

        .logo {
            text-align: center;
            margin: 20px;
        }

        .logo img {
            max-width: 300px;
        }

        .code-block {
            text-align: center;
            margin-top: 12px;
            font-family: 'Roboto Mono', monospace;
            color: #c7254e;
            background: #fbeaea;
            display: inline-block;
            padding: 6px 10px;
            border-radius: 4px;
        }

        .summary {
            background: #eef6fb;
            padding: 16px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .visual {
            text-align: center;
            margin-top: 30px;
        }

        .visual img {
            max-width: 100%;
            border-radius: 8px;
        }

        .note {
            font-size: 0.9rem;
            color: #555;
            text-align: center;
            margin-top: 10px;
        }

        img {
            display: block;
            max-width: 100%;
            margin: 20px auto;
        }

        summary {
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            background: #eef4ff;
            padding: 10px 16px;
            border-radius: 6px;
            margin: 1.5rem 0;
        }

        details[open] summary {
            background: #dde8ff;
        }

        table {
            background-color: #ffffff;
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 13.5px;
            font-family: 'Roboto', sans-serif;
        }

        th {
            background: #ebccff;
            padding: 10px;
            font-weight: 600;
            text-align: center;
            font-family: 'Inter', sans-serif;
        }

        td {
            padding: 6px 8px;
            border: 1px solid #ddd;
            text-align: center;
        }

        tr:nth-child(even) {
            background-color: #fafafa;
        }

        tr.highlight {
            background-color: rgba(248, 101, 101, 0.2);
        }

        .std {
            font-size: 11px;
            font-family: 'Roboto Mono', monospace;
            color: #555;
        }

        .bold {
            font-weight: 600;
        }

        .underline {
            text-decoration: underline;
        }

        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .figure-caption-overview {
            background-color: #f0f4ff; /* light blue background */
            padding: 16px;
            border-left: 4px solid #4b6cb7; /* accent bar */
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Source Sans Pro', sans-serif;
            color: #1a1a1a;
            margin-top: 1rem;
            margin-bottom: 2rem;
            text-align: justify;
        }

        .equation-box {
            font-size: 18px;
            background-color: #f3f8ff;
            padding: 10px;
            border-radius: 10px;
            margin: 2rem 0;
            font-family: 'Georgia', serif;
            color: #1f2937;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #dbeafe;
        }

        .equation-box h3 {
            font-family: 'Merriweather', serif;
            font-size: 18px;
            color: #2c5282;
            margin-bottom: 1rem;
        }


    </style>
</head>

<script>
    window.MathJax = {
        tex: {
            inlineMath: [['\\(', '\\)']],
            displayMath: [['\\[', '\\]'], ['$$', '$$']]
        }
    };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

<body>

<h1>Diversified Prototypical Ensembles</h1>
<p class="institution">Accepted at the International Conference on Machine Learning (ICML) 2025</p>

<div class="authors">
    Minh Nguyen Nhat To · Paul F R Wilson · Viet Nguyen · Mohamed Harmanani · Michael Cooper<br>
    Fahimeh Fooladgar · Purang Abolmaesumi · Parvin Mousavi · Rahul G. Krishnan
</div>

<div class="links">
    <a href="https://arxiv.org/abs/your-id" class="button" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="34" height="16" viewBox="0 0 90 24"
             style="vertical-align: middle; margin-right: 6px;">
            <text x="0" y="16" font-family="Arial, sans-serif" font-size="24" fill="white">arXiv</text>
        </svg>
        Paper
    </a>

    <a href="https://github.com/your-repo" class="button" target="_blank">
        <!-- SVG goes here -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16" fill="white"
             style="vertical-align: middle; margin-right: 6px;">
            <path d="M8 0C3.58 0 0 3.58 0 8a8 8 0 005.47 7.59c.4.07.55-.17.55-.38
      0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01
      1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
      0-.87.31-1.59.82-2.15-.08-.2-.36-1.01.08-2.11 0 0 .67-.21 2.2.82a7.65 7.65 0 012 0c1.53-1.03
      2.2-.82 2.2-.82.44 1.1.16 1.91.08 2.11.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65
      3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01
      8.01 0 0016 8c0-4.42-3.58-8-8-8z"/>
        </svg>
        Reproduce
    </a>

    <a href="https://openreview.net/forum?id=your_submission_id" class="button" target="_blank">
        <svg height="16" viewBox="0 0 100 100" style="vertical-align: middle; margin-right: 6px;">
            <rect width="100" height="100" fill="#881C1C"/>
            <text x="10" y="35" font-family="Arial, sans-serif" font-size="24" fill="white">Open</text>
            <text x="10" y="60" font-family="Arial, sans-serif" font-size="24" fill="white">Review</text>
            <text x="10" y="85" font-family="Arial, sans-serif" font-size="20" fill="lightgray">.net</text>
        </svg>
        OpenReview
    </a>
</div>

<!--<div class="logo">-->
<!--    <img src="figures/motivation.png" alt="DPE Logo or Teaser Figure">-->
<!--</div>-->

<div style="text-align: center;">
    <div class="code-block">pip install dpe</div>
</div>

<div class="visual">
    <img src="figures/embeddings_figure.png" alt="Diagram Overview of DPE">

    <div class="figure-caption-overview">
        <p>
            <strong>(1)</strong> Binary classification with implicit (unannotated) subgroups. The goal is to detect and
            correct for subpopulation shifts without prior group knowledge.
            <strong>(2)</strong> A <span class="feature-extractor">frozen feature extractor</span>, <i>f(·)</i>, is used
            to extract features.
            <strong>(3)</strong> We train an ensemble of <i>N</i> prototype classifiers per class, using the IPS loss
            (Eq. 4) to encourage diversity and discover latent subpopulations.
            <strong>(4)</strong> A 2D projection shows centroids and sample proximity for the “Landbird” class in <i>Waterbirds</i>.
            Samples closest to each centroid are shown in blue, farther ones in red, and the closest few in dark blue.
            <strong>(5)</strong> Image patches nearest to each centroid confirm that learned prototypes align with
            meaningful subgroups (e.g., birds on land vs. in water).
        </p>
    </div>
</div>

<div class="card-section summary-section">
    <h2>Summary</h2>
    <p>
        Subpopulation shifts occur when the distribution of data subgroups differs between training and deployment
        environments. These shifts can significantly degrade the generalization performance of machine learning models,
        especially when subgroup annotations are unavailable. Existing solutions often rely on reweighting or
        subgroup-specific adjustments, which require prior knowledge or annotations that are difficult to obtain in
        real-world applications.
    </p>
    <p>
        We introduce <strong>Diversified Prototypical Ensembles (DPE)</strong>, a method that improves robustness by
        training a collection of prototype classifiers. Each classifier is designed to focus on different subsets of the
        data and different features. By encouraging diversity among ensemble members, DPE captures multiple decision
        boundaries, enabling better generalization across a wide range of subpopulations.
    </p>
    <p><strong>Key Contributions:</strong></p>
    <ul>
        <li>We propose an end-to-end framework that promotes diversity within an ensemble of prototype-based
            classifiers, each capturing complementary decision rules.
        </li>
        <li>DPE replaces the standard linear head with multiple prototype heads trained using a combination of
            diversification loss and sample resampling.
        </li>
        <li>We demonstrate state-of-the-art performance on nine datasets, achieving improved worst-group accuracy under
            various types of subpopulation shift such as attribute imbalance, spurious correlations, and previously
            unseen attribute values.
        </li>
    </ul>
</div>

<div class="card-section">
    <h2>Motivation</h2>
    <p>
        In real-world datasets, classifiers often learn to rely on shortcuts or spurious features that correlate with
        the labels in the training distribution but fail to hold in deployment. These failures are especially severe
        when certain subgroups are underrepresented or shift at test time, making it difficult for the model to learn a
        single decision boundary that generalizes well.
    </p>
    <p>
        A natural solution is to move beyond a single global decision rule. When a model is encouraged to consider
        multiple distinct ways to separate the data, it becomes more likely that at least one decision rule will align
        with the correct semantics across diverse subpopulations. This forms the key insight behind our approach.
    </p>
    <p>
        Rather than relying on prior knowledge of subgroup structure, we explore the feature space. By
        training multiple classifiers that are explicitly encouraged to be different from one another, we can uncover a
        richer set of decision boundaries that are more robust to distribution shifts.
    </p>
</div>


<div class="visual">
    <img src="figures/motivation.png" alt="Diagram Overview of DPE">

    <div class="note">Motivation of DPE. (a) A single model trained on mixed subgroups learns a biased decision boundary
        favoring the majority. (b–d) As ensemble size increases, each model captures different subgroup patterns,
        improving classification across subpopulations.
    </div>

</div>




<div class="card-section" id="method">
    <h2 style="text-align: center;">Method</h2>

    <p>
        <strong>DPE</strong> is a two-stage approach that improves
        robustness to subpopulation shifts by training an ensemble of diverse prototype classifiers.
    </p>

    <div class="card-section equation-box">
    <h3>Prototypical Classifier</h3>
    <p>
        The model assigns the probability of class \( y \) based on the distance between the extracted feature
        representation \( f(x) \) and the prototype \( p_y \). A softmax over the negative distances is used to produce
        a valid probability distribution:
    </p>
    <div style="text-align: center;">
        $$ P(y \mid x) = \mathrm{softmax}(-D(f(x), p_y)) $$
    </div>
</div>

<div class="card-section equation-box">
    <h3>Prototypical Ensemble </h3>
    <p>
        To encourage diversity among prototypes within each class, we minimize the average absolute cosine similarity
        between all pairs of prototypes for a given class:
    </p>
    <div style="text-align: center;">
        $$ \mathcal{L}_{\text{IPS}} = \frac{1}{K \cdot n \cdot d} \sum_{k=1}^K \sum_{i \ne j} \left| \langle p^{(k)}_i,
        p^{(k)}_j \rangle \right| $$
    </div>
</div>


</div>

<div class='table-box' id="wga-no-attributes">
    <h2 style="text-align: center;">Worst-Group Accuracy (Without Subgroup Annotations)</h2>
    <p>
        The top section presents SubpopBench-style baselines using an ERM backbone.
        The bottom section includes recent state-of-the-art methods and our method using a stronger ERM<sup>*</sup>
        backbone.
        DPE denotes our diversified prototypical ensemble.
    </p>
    <table>
        <thead>
        <tr>
            <th>Algorithm</th>
            <th>Waterbirds</th>
            <th>CelebA</th>
            <th>CivilComments</th>
            <th>MultiNLI</th>
            <th>MetaShift</th>
            <th>CheXpert</th>
            <th>ImageNetBG</th>
            <th>NICO++</th>
            <th>Living17</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><strong>ERM</strong></td>
            <td>69.1 <span class="std">±4.7</span></td>
            <td>57.6 <span class="std">±0.8</span></td>
            <td>63.2 <span class="std">±1.2</span></td>
            <td><b>66.4</b> <span class="std">±2.3</span></td>
            <td>82.1 <span class="std">±0.8</span></td>
            <td>41.7 <span class="std">±3.4</span></td>
            <td>76.8 <span class="std">±0.9</span></td>
            <td>35.0 <span class="std">±4.1</span></td>
            <td>48.0 <span class="std">±1.5</span></td>
        </tr>
        <tr>
            <td><strong>CRT</strong></td>
            <td>76.3 <span class="std">±0.8</span></td>
            <td>69.6 <span class="std">±0.7</span></td>
            <td><b>67.8</b> <span class="std">±0.3</span></td>
            <td>65.4 <span class="std">±0.2</span></td>
            <td>83.1 <span class="std">±0.0</span></td>
            <td>74.6 <span class="std">±0.4</span></td>
            <td><b>78.2</b> <span class="std">±0.5</span></td>
            <td>33.3 <span class="std">±0.0</span></td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>ReWeightCRT</strong></td>
            <td>76.3 <span class="std">±0.2</span></td>
            <td>70.7 <span class="std">±0.6</span></td>
            <td>64.7 <span class="std">±0.2</span></td>
            <td>65.2 <span class="std">±0.2</span></td>
            <td><b><u>85.1</u></b> <span class="std">±0.4</span></td>
            <td><b>75.1</b> <span class="std">±0.2</span></td>
            <td>77.5 <span class="std">±0.7</span></td>
            <td>33.3 <span class="std">±0.0</span></td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>DFR</strong></td>
            <td><b>89.0</b> <span class="std">±0.2</span></td>
            <td><b>73.7</b> <span class="std">±0.8</span></td>
            <td>64.4 <span class="std">±0.1</span></td>
            <td>63.8 <span class="std">±0.0</span></td>
            <td>81.4 <span class="std">±0.1</span></td>
            <td><b><u>75.8</u></b> <span class="std">±0.3</span></td>
            <td>74.4 <span class="std">±1.8</span></td>
            <td><b>38.0</b> <span class="std">±3.8</span></td>
            <td>–</td>
        </tr>
        <tr class="highlight">
            <td><strong>ERM + DPE</strong></td>
            <td><b><u>91.0</u></b> <span class="std">±0.5</span></td>
            <td><b><u>81.9</u></b> <span class="std">±0.2</span></td>
            <td><b><u>69.9</u></b> <span class="std">±0.9</span></td>
            <td><b><u>69.3</u></b> <span class="std">±0.8</span></td>
            <td><b>84.1</b> <span class="std">±1.5</span></td>
            <td>–</td>
            <td><b><u>87.9</u></b> <span class="std">±0.6</span></td>
            <td><b><u>50.0</u></b> <span class="std">±0.0</span></td>
            <td><b><u>54.0</u></b> <span class="std">±4.0</span></td>
        </tr>
        <tr>
            <td><strong>ERM*</strong></td>
            <td>77.9 <span class="std">±3.0</span></td>
            <td>66.5 <span class="std">±2.6</span></td>
            <td><b><u>69.4</u></b> <span class="std">±1.2</span></td>
            <td>66.5 <span class="std">±0.7</span></td>
            <td>80.0 <span class="std">±0.0</span></td>
            <td>75.6 <span class="std">±0.4</span></td>
            <td>86.4 <span class="std">±0.8</span></td>
            <td>33.3 <span class="std">±0.0</span></td>
            <td>53.3 <span class="std">±0.9</span></td>
        </tr>
        <tr>
            <td><strong>RWY</strong></td>
            <td>86.1 <span class="std">±0.7</span></td>
            <td><b>82.9</b> <span class="std">±2.2</span></td>
            <td>67.5 <span class="std">±0.6</span></td>
            <td>68.0 <span class="std">±1.9</span></td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>AFR</strong></td>
            <td><b>90.4</b> <span class="std">±1.1</span></td>
            <td>82.0 <span class="std">±0.5</span></td>
            <td>68.7 <span class="std">±0.6</span></td>
            <td><b><u>73.4</u></b> <span class="std">±0.6</span></td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr class="highlight">
            <td><strong>ERM* + DPE</strong></td>
            <td><b><u>94.1</u></b> <span class="std">±0.2</span></td>
            <td><b><u>84.6</u></b> <span class="std">±0.8</span></td>
            <td><b>68.9</b> <span class="std">±0.6</span></td>
            <td><b>70.9</b> <span class="std">±0.8</span></td>
            <td><b><u>83.6</u></b> <span class="std">±0.9</span></td>
            <td><b><u>76.8</u></b> <span class="std">±0.1</span></td>
            <td><b><u>88.1</u></b> <span class="std">±0.7</span></td>
            <td><b><u>50.0</u></b> <span class="std">±0.0</span></td>
            <td><b><u>63.0</u></b> <span class="std">±1.7</span></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="table-box" id="wga-with-attributes">
    <h2 style="text-align: center;">Worst-Group Accuracy (With Attribute Annotations)</h2>
    <p>
        The top section reproduces SubpopBench baselines using the same ERM backbone. The bottom includes results from
        original papers and our method (DPE) applied to a stronger ERM<sup>*</sup> backbone.
        Bold and underlined values indicate the best result per group, bold values indicate the second-best.
    </p>
    <table>
        <thead>
        <tr>
            <th>Algorithm</th>
            <th>Group Info (Train/Val)</th>
            <th>Waterbirds</th>
            <th>CelebA</th>
            <th>CivilComments</th>
            <th>MultiNLI</th>
            <th>MetaShift</th>
            <th>CheXpert</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><strong>ERM</strong></td>
            <td>❌/❌</td>
            <td>69.1 <span class="std">±4.7</span></td>
            <td>57.6 <span class="std">±0.8</span></td>
            <td>63.2 <span class="std">±1.2</span></td>
            <td><b>66.4</b> <span class="std">±2.3</span></td>
            <td>82.1 <span class="std">±0.8</span></td>
            <td>41.7 <span class="std">±3.4</span></td>
        </tr>
        <tr>
            <td><strong>CRT</strong></td>
            <td>❌/✔️</td>
            <td>76.3 <span class="std">±0.8</span></td>
            <td>70.4 <span class="std">±0.4</span></td>
            <td><b>68.5</b> <span class="std">±0.0</span></td>
            <td>65.4 <span class="std">±0.1</span></td>
            <td>83.1 <span class="std">±0.0</span></td>
            <td><b>74.0</b> <span class="std">±0.2</span></td>
        </tr>
        <tr>
            <td><strong>ReWeightCRT</strong></td>
            <td>❌/✔️</td>
            <td>76.3 <span class="std">±0.2</span></td>
            <td>71.1 <span class="std">±0.5</span></td>
            <td>68.2 <span class="std">±0.4</span></td>
            <td>65.3 <span class="std">±0.1</span></td>
            <td><b><u>85.1</u></b> <span class="std">±0.4</span></td>
            <td>73.9 <span class="std">±0.2</span></td>
        </tr>
        <tr>
            <td><strong>DFR</strong></td>
            <td>❌/✔️✔️</td>
            <td><b>89.0</b> <span class="std">±0.2</span></td>
            <td><b>86.3</b> <span class="std">±0.3</span></td>
            <td>66.5 <span class="std">±0.2</span></td>
            <td>63.8 <span class="std">±0.0</span></td>
            <td>81.5 <span class="std">±0.0</span></td>
            <td><b><u>75.4</u></b> <span class="std">±0.6</span></td>
        </tr>
        <tr class="highlight">
            <td><strong>ERM + DPE</strong></td>
            <td>❌/✔️✔️</td>
            <td><b><u>91.0</u></b> <span class="std">±0.4</span></td>
            <td><b><u>87.7</u></b> <span class="std">±0.6</span></td>
            <td><b><u>71.5</u></b> <span class="std">±0.6</span></td>
            <td><b><u>74.8</u></b> <span class="std">±0.3</span></td>
            <td><b>87.9</b> <span class="std">±0.7</span></td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>ERM*</strong></td>
            <td>❌/❌</td>
            <td>77.9 <span class="std">±3.0</span></td>
            <td>66.5 <span class="std">±2.6</span></td>
            <td>69.4 <span class="std">±1.2</span></td>
            <td>66.5 <span class="std">±0.7</span></td>
            <td>80.0 <span class="std">±0.0</span></td>
            <td>75.6 <span class="std">±0.4</span></td>
        </tr>
        <tr>
            <td><strong>Group DRO</strong></td>
            <td>✔️/✔️</td>
            <td>91.4 <span class="std">±1.1</span></td>
            <td>88.9 <span class="std">±2.3</span></td>
            <td>70.0 <span class="std">±2.0</span></td>
            <td><b>77.7</b> <span class="std">±1.4</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>RWG</strong></td>
            <td>✔️/✔️</td>
            <td>87.6 <span class="std">±1.6</span></td>
            <td>84.3 <span class="std">±1.8</span></td>
            <td><b><u>72.0</u></b> <span class="std">±1.9</span></td>
            <td>69.6 <span class="std">±1.0</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>JTT</strong></td>
            <td>❌/✔️</td>
            <td>86.7</td>
            <td>81.1</td>
            <td>69.3</td>
            <td>72.6</td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>CnC</strong></td>
            <td>❌/✔️</td>
            <td>88.5 <span class="std">±0.3</span></td>
            <td>88.8 <span class="std">±0.9</span></td>
            <td>68.9 <span class="std">±2.1</span></td>
            <td>–</td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>SSA</strong></td>
            <td>❌/✔️✔️</td>
            <td>89.0 <span class="std">±0.6</span></td>
            <td>89.8 <span class="std">±1.3</span></td>
            <td>69.9 <span class="std">±2.0</span></td>
            <td>76.6 <span class="std">±0.7</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>DFR*</strong></td>
            <td>❌/✔️✔️</td>
            <td>92.9 <span class="std">±0.2</span></td>
            <td>88.3 <span class="std">±1.1</span></td>
            <td>70.1 <span class="std">±0.8</span></td>
            <td>74.7 <span class="std">±0.7</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>GAP (Last Layer)</strong></td>
            <td>❌/✔️✔️</td>
            <td>93.2 <span class="std">±0.2</span></td>
            <td><b>90.2</b> <span class="std">±0.3</span></td>
            <td>–</td>
            <td>74.3 <span class="std">±0.2</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr>
            <td><strong>GAP (All Layer)</strong></td>
            <td>❌/✔️✔️</td>
            <td><b>93.8</b> <span class="std">±0.1</span></td>
            <td><b>90.2</b> <span class="std">±0.3</span></td>
            <td>–</td>
            <td><b><u>77.8</u></b> <span class="std">±0.6</span></td>
            <td>–</td>
            <td>–</td>
        </tr>
        <tr class="highlight">
            <td><strong>ERM* + DPE</strong></td>
            <td>❌/✔️✔️</td>
            <td><b><u>94.1</u></b> <span class="std">±0.4</span></td>
            <td><b><u>90.3</u></b> <span class="std">±0.7</span></td>
            <td><b>70.8</b> <span class="std">±0.8</span></td>
            <td>75.3 <span class="std">±0.5</span></td>
            <td><b><u>91.7</u></b> <span class="std">±1.3</span></td>
            <td><b><u>76.0</u></b> <span class="std">±0.3</span></td>
        </tr>
        </tbody>
    </table>
</div>




<h2>BibTeX</h2>
<pre>
@inproceedings{to2025dpe,
  title={Diverse Prototypical Ensembles Improve Robustness to Subpopulation Shift},
  author={To, Minh Nguyen Nhat and Wilson, Paul F R and Nguyen, Viet and Harmanani, Mohamed and Cooper, Michael and
          Fooladgar, Fahimeh and Abolmaesumi, Purang and Mousavi, Parvin and Krishnan, Rahul},
  booktitle={International Conference on Machine Learning (ICML)},
  year={2025}
}
</pre>


</body>
</html>
